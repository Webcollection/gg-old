;(function () {

    // This file contains the code to define the graphics and then
    // renders them using data randomly generated by data.js.

    $(document).ready(function() {

        // Define graphics ...

        var scatterplot = gg({
            mapping: {x: '-d', y: 'r'},
            layers: [
                { geometry: 'line', mapping: { group: 't', color: 'Math.floor(r/10)'} }
                ,{ geometry: 'point', mapping: {y: 'r + 10', size: 'r', color: "t"},
                  position: 'jitter'}
            ],
            scales: [
                { aesthetic: 'size', range: [1, 4] }
                //,{ aes: 'x', lim: [-50, 50], range: [10, 300]}
                //,{ aesthetic: 'y', domain: [-50, 50]}
            ]
            ,facets: { x: 'f', y: 'g', scales:'fixed'}

        });


        var w    = 1300;
        var h    = 1000;
        var ex   = function () { return d3.select('#examples').append('span'); };

        var bigdata = _.map(_.range(0, 5000), function(d) {
            g = Math.floor(Math.random() * 3);
            f = Math.floor(Math.random() * 3) * 10;
            t = Math.floor(Math.random() * 3)
            return {d:d, r: d * t * 0.05 + Math.random() + f, g: g, f:f, t:t};
        })
        scatterplot.renderer(w, h, ex())(bigdata)
    });
})();
