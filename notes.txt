GGplot2 notes
---------------

Processing flow

graphic.opts --> what?
graphic.render -> facets.render
layer -> trainscales

at what point does data acces turn into data[@variable]
aesthetics are currently all keys in mappings other than group
what is @aes?


graphic contains multiple layers.  move layers into facet


fromSpec = (spec, graphic) -> ...

spec:
  layers: [ {  geometry:,
               mapping: {
                   x:, y:, group:, color:, text:, show
               }
               statistic: {kind: 'identity', group: function, variable}
               visual attributes (e.g., size, fill, width, etc)
           }]

opts
  paddingX, paddingY, padding

Graphic
    ensureScales: make sure each aesthetic has a scale
    prepareLayers: calles prepare on each layer
    aesthetic -> scale
    render: create container, call facet.render

GricFacet
    render:
        ensure scales of each subfacet, prepare their layers
        draw overall axes


Facet
    render:
        call Graphic to ensure scales, prepare layers (bulk of work)
        draw axes and tick marks
        call layer.render with new 'g' dom element


Layer
    tied together with a geometry
    computes statistics, groups, updates scales, and calles geom.render
    statistic
    trainScales
        for each aesthetic, set/learn the domain of the data
        XXX currently trains on the first layer and stops (domainSet variable)
    prepare
        replace data with computed statistics
        turn data into groups using mappings.group
        trainscales on new data
    render
        call geometry.render()

Geometry
    the data has a well defined schema
    render the svg objects
        takes groups as input, so need to consider that!
    load rendering attributes like size, color, width, fill from spec toplevel






Scale
    has handle to Graphic to determin global min, max values
    tied to a specific aesthetic (defaultFor(aesthetic) -> Scale object)


Questions

1. where to hook in interaction?  click, drag, select, brush, link, change dimensions, zoom
2. where to hook in custom theme?  (at least coloring)



* Tricky plots to draw

* Other pitfalls

* Crazy ideas
